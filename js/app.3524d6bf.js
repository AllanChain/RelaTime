(function(e){function t(t){for(var r,o,c=t[0],s=t[1],u=t[2],v=0,d=[];v<c.length;v++)o=c[v],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/RelaTime/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"04d4":function(e,t,n){"use strict";var r=n("ce24"),a=n.n(r);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("Drawer",{model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}}),n("v-app-bar",{attrs:{app:"",color:"primary",dark:"",dense:""}},[n("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),n("v-toolbar-title",{staticClass:"pa-0"},[e._v("RelaTime")]),n("v-spacer"),n("ICALProcessor",{on:{update:e.updateCal}}),n("v-btn",{attrs:{icon:"",text:"",small:""},on:{click:function(t){t.stopPropagation(),e.dialog=!0}}},[n("v-icon",[e._v("mdi-plus")])],1)],1),n("v-content",[n("Calendar",{ref:"calendar"})],1)],1)},i=[],o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-btn",{attrs:{icon:"",text:"",small:""},on:{click:function(t){return t.stopPropagation(),e.doUpload(t)}}},[n("v-icon",[e._v("mdi-upload")])],1),n("input",{ref:"file",attrs:{type:"file",accept:".ics",hidden:""},on:{change:e.handleICS}})],1)},c=[],s=(n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("ac1f"),n("3ca3"),n("466d"),n("ddb0"),n("96cf"),n("1da1")),u=n("51e0"),l=n.n(u),v="veventdb",d=1,f={name:"idb",db:null,init:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.db){e.next=4;break}return e.next=3,this.getDB();case 3:this.db=e.sent;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),translateEvent:function(e){return e.event=new l.a.Event(new l.a.Component(JSON.parse(e.event))),e},getDB:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n=window.indexedDB.open(v,d);n.onupgradeneeded=function(e){var t=e.target.result,n=t.createObjectStore("vevents",{autoIncrement:!0,keyPath:"id"});n.createIndex("course","course")},n.onerror=function(e){return t(new Error("Reject!!"))},n.onsuccess=function(t){return e(t.target.result)}})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getVevents:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.db.transaction(["vevents"],"readonly"),a=r.objectStore("vevents"),i=[];a.openCursor().onsuccess=function(e){var n=e.target.result;if(n){var r=t.translateEvent(n.value);i.push(r),n.continue()}},r.oncomplete=function(t){return e(i)}})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getVeventByID:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var r=n.db.transaction(["vevents"],"readonly"),a=r.objectStore("vevents").get(t);a.onsuccess=function(){return e(n.translateEvent(a.result))}})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),addVeventToDB:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var a=n.db.transaction(["vevents"],"readwrite");a.oncomplete=function(t){return e()},a.objectStore("vevents").add(t)})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),deleteVevent:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.deleteVeventFromDB(t);case 2:return e.next=4,this.getVevents();case 4:this.vevents=e.sent;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deleteVeventFromDB:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var a=n.db.transaction(["vevents"],"readwrite");a.oncomplete=function(t){return e()},a.objectStore("vevents").delete(t)})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},p={name:"utils",h:0,randColor:function(){return this.h=(this.h+90+Math.round(20*Math.random()))%360,{h:this.h,s:Math.round(60+40*Math.random()),l:Math.round(40+20*Math.random())}}},h={name:"ICALProcessor",methods:{doUpload:function(){this.$refs.file.click()},handleICS:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,r,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.target.files[0],r=new FileReader,r.onload=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,r,i,o,c,s,u,v,d,h,m,g,b,w,y,k;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(n=t.target.result,r=l.a.parse(n),i=new l.a.Component(r),o=i.getAllSubcomponents("vevent"),c={},s=[],u=!0,v=!1,d=void 0,e.prev=9,h=o[Symbol.iterator]();!(u=(m=h.next()).done);u=!0)g=m.value,b=new l.a.Event(g),w=b.summary,y="",k=w.match(/^(.*?)(习题|上机)课*?$/),k&&(w=k[1],y=k[2]),w in c||(c[w]=p.randColor()),s.push(f.addVeventToDB({event:JSON.stringify(g),course:w,mod:y,color:c[w]}));e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](9),v=!0,d=e.t0;case 17:e.prev=17,e.prev=18,u||null==h.return||h.return();case 20:if(e.prev=20,!v){e.next=23;break}throw d;case 23:return e.finish(20);case 24:return e.finish(17);case 25:Promise.all(s),a.$emit("update");case 27:case"end":return e.stop()}}),e,null,[[9,13,17,25],[18,,20,24]])})));return function(t){return e.apply(this,arguments)}}(),r.readAsText(n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}},m=h,g=n("2877"),b=n("6544"),w=n.n(b),y=n("8336"),k=n("132d"),x=Object(g["a"])(m,o,c,!1,null,null,null),_=x.exports;w()(x,{VBtn:y["a"],VIcon:k["a"]});var O,D,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cal-all",on:{touchstart:e.touchStart,touchend:e.touchEnd}},[n("div",{staticClass:"cal-head"},e._l(e.formatDates,(function(t){return n("div",{key:t,staticClass:"date"},[e._v(e._s(t))])})),0),n("div",{ref:"container",staticClass:"cal-container"},[e.ready?n("div",{staticClass:"calendar",style:{height:90*e.zoom+"vh"}},[n("div",{staticClass:"time-lines"},[n("div",{style:{height:e.timeHintPadding}}),e._l(24,(function(e){return n("div",{key:e,staticClass:"line"})}))],2),n("div",{staticClass:"time-hint"},[n("div",{style:{height:"calc("+e.timeHintPadding+" - 9px)"}}),e._l(e.timeHints,(function(t){return n("p",{key:t,staticClass:"time"},[e._v(e._s(t))])}))],2),e._l(e.displayList,(function(t,r){return n("div",{key:r,staticClass:"day",class:{active:r===e.dayOfWeek}},e._l(t,(function(t,r){return n("div",{key:r,staticClass:"event",style:{height:t.height,top:t.top,"background-color":t.color},on:{click:function(n){e.editingID=t.id}}},[n("span",{staticClass:"course"},[e._v(e._s(t.course))]),t.mod?n("span",{staticClass:"mod"},[e._v(e._s(t.mod))]):e._e(),n("span",{staticClass:"location"},[e._v(e._s(t.location))])])})),0)}))],2):e._e()]),n("EventDialog",{attrs:{id:e.editingID},on:{finish:function(t){e.editingID=null}}})],1)},V=[],j=(n("99af"),n("a623"),n("c8b5")),S=n.n(j),R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return null!=e.vevent?n("v-dialog",{attrs:{value:null!=e.vevent,"max-width":"290"},on:{input:e.finish}},[n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[n("v-toolbar-title",[e._v("Modify Event")]),n("v-spacer"),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-btn",e._g({attrs:{icon:"",large:""}},r),[n("v-icon",[e._v("delete")])],1)]}}],null,!1,96383864)},[n("span",[e._v("Delete")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-btn",e._g({attrs:{icon:"",large:""}},r),[n("v-icon",[e._v("cancel")])],1)]}}],null,!1,2347549511)},[n("span",[e._v("Cancel")])])],1),n("v-card-text",{staticClass:"pa-1"},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Course","prepend-inner-icon":"school",type:"text"},model:{value:e.vevent.course,callback:function(t){e.$set(e.vevent,"course",t)},expression:"vevent.course"}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Module","prepend-inner-icon":"extension",type:"text"},model:{value:e.vevent.mod,callback:function(t){e.$set(e.vevent,"mod",t)},expression:"vevent.mod"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Location","prepend-inner-icon":"place",type:"text"},model:{value:e.vevent.event.location,callback:function(t){e.$set(e.vevent.event,"location",t)},expression:"vevent.event.location"}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Description","prepend-inner-icon":"description",type:"text"},model:{value:e.vevent.event.description,callback:function(t){e.$set(e.vevent.event,"description",t)},expression:"vevent.event.description"}})],1)],1),e._l(e.times,(function(t,r){return n("v-row",{key:r},[n("v-col",{attrs:{cols:"12"}},[n("v-icon",[e._v("access_time")]),e._l(t,(function(t,r){return n("v-menu",{key:r,attrs:{"close-on-content-click":!1,width:"290px","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(r){var a=r.on;return[n("v-btn",e._g({attrs:{text:"",small:""}},a),[e._v(e._s(t.time))])]}}],null,!0),model:{value:t.editing,callback:function(n){e.$set(t,"editing",n)},expression:"atime.editing"}},[t.editing?n("v-time-picker",{attrs:{"full-width":"",format:"24hr"},model:{value:t.time,callback:function(n){e.$set(t,"time",n)},expression:"atime.time"}}):e._e()],1)}))],2)],1)}))],2)],1)],1)],1):e._e()},T=[],I=function(e){var t=e.getHours();t<10&&(t="0"+t);var n=e.getMinutes();return n<10&&(n="0"+n),t+":"+n},M={name:"EventDialog",props:["id"],data:function(){return{vevent:null,times:[]}},watch:{id:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return this.times=[],e.next=4,f.getVeventByID(t);case 4:this.vevent=e.sent,this.times.push([{time:I(this.vevent.event.startDate.toJSDate()),editing:!1},{time:I(this.vevent.event.endDate.toJSDate()),editing:!1}]),e.next=9;break;case 8:this.vevent=null;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},methods:{finish:function(e){this.$emit("finish",{})}}},P=M,$=n("b0af"),E=n("99d9"),B=n("62ad"),W=n("a523"),A=n("169a"),L=n("e449"),H=n("0fd9"),N=n("2fa4"),F=n("8654"),J=n("c964"),z=n("71d9"),U=n("2a7f"),Y=n("3a2f"),q=Object(g["a"])(P,R,T,!1,null,null,null),Z=q.exports;w()(q,{VBtn:y["a"],VCard:$["a"],VCardText:E["a"],VCol:B["a"],VContainer:W["a"],VDialog:A["a"],VIcon:k["a"],VMenu:L["a"],VRow:H["a"],VSpacer:N["a"],VTextField:F["a"],VTimePicker:J["a"],VToolbar:z["a"],VToolbarTitle:U["a"],VTooltip:Y["a"]});var G={name:"Calendar",components:{EventDialog:Z},data:function(){return{ready:!1,addDisabled:!1,vevents:[],owlMode:26600,zoom:2,scroll:.2,firstDayOfWeek:1,date:new Date(2019,10,3),alpha:.7,editingID:null,touchThreshold:40}},created:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f.init();case 2:f.getVevents().then((function(e){t.vevents=e,t.ready=!0,r["a"].nextTick((function(){var e=t.$refs.container;e.scrollTo({top:e.scrollHeight*t.scroll})}))}));case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){var e=this;D=new S.a.Manager(this.$refs.container),D.add(new S.a.Swipe({direction:S.a.DIRECTION_HORIZONTAL})),D.add(new S.a.Pinch({enable:!1})),D.on("pinchstart",this.pinchStart),D.on("pinchmove",this.pinchMove),D.on("swipeleft",(function(){e.date=new Date(+e.date+6048e5)})),D.on("swiperight",(function(){e.date=new Date(+e.date-6048e5)}))},methods:{update:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f.getVevents();case 2:this.vevents=e.sent;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),pinchStart:function(e){O=this.zoom},pinchMove:function(e){this.zoom=O*e.scale},touchStart:function(e){e.touches.length>1&&D.get("pinch").set({enable:!0})},touchEnd:function(e){D.get("pinch").set({enable:!1})}},computed:{formatDates:function(){for(var e=[],t=0;t<7;t++){var n=new Date(this.startOfWeek.getTime()+864e5*t);e.push("".concat(n.getMonth()+1,"-").concat(n.getDate()))}return e},timeHints:function(){for(var e=Math.floor(this.owlMode/3600)+1,t=[e],n=e+1;n<24;n++)t.push(n);for(var r=0;r<e;r++)t.push(r);return t},timeHintPadding:function(){var e=this.owlMode/3600;return(Math.floor(e)+1-e)/24*100+"%"},dayOfWeek:function(){return(this.date.getDay()-this.firstDayOfWeek+7)%7},startOfWeek:function(){return new Date(this.date.getTime()-864e5*this.dayOfWeek+1e3*this.owlMode)},endOfWeek:function(){return new Date(this.startOfWeek.getTime()+6048e5)},displayList:function(){for(var e=[],t=0;t<7;t++)e.push([]);var n,r=function(e){return e.every((function(e){return e>=0}))||e.every((function(e){return e<=0}))},a=!0,i=!1,o=void 0;try{for(var c,s=this.vevents[Symbol.iterator]();!(a=(c=s.next()).done);a=!0){var u=c.value,l=u.event,v=l.duration.toSeconds(),d=l.iterator();while(n=d.next()){var f=n.toJSDate();if(f>this.endOfWeek)break;var p=new Date(f.getTime()+1e3*v);if(!r([f-this.startOfWeek,f-this.endOfWeek,p-this.startOfWeek,p-this.endOfWeek])){var h=!1,m=!0,g=!1,b=void 0;try{for(var w,y=d.exDates[Symbol.iterator]();!(m=(w=y.next()).done);m=!0){var k=w.value;if(k=k.toJSDate(),k.getFullYear()===f.getFullYear()&&k.getMonth()===f.getMonth()&&k.getDate()===f.getDate()){h=!0;break}}}catch(D){g=!0,b=D}finally{try{m||null==y.return||y.return()}finally{if(g)throw b}}if(h)continue;var x=(f.getTime()-this.startOfWeek.getTime())/1e3,_=Math.floor(x/86400),O=u.color;e[_].push({course:u.course,mod:u.mod,color:"hsla(".concat(O.h,", ").concat(O.s,"%, ").concat(O.l,"%, ").concat(this.alpha,")"),location:u.event.location,description:u.event.description,top:x%86400/864+"%",height:v/864+"%",id:u.id})}}}}catch(D){i=!0,o=D}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return e}}},K=G,Q=(n("04d4"),Object(g["a"])(K,C,V,!1,null,null,null)),X=Q.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-navigation-drawer",{attrs:{value:e.value,app:""},on:{input:e.handleInput}},[n("v-list",{attrs:{dense:""}},[n("v-list-item",{attrs:{link:""}},[n("v-list-item-action",[n("v-icon",[e._v("mdi-home")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Home")])],1)],1),n("v-list-item",{attrs:{link:""}},[n("v-list-item-action",[n("v-icon",[e._v("mdi-contact-mail")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Contact")])],1)],1)],1)],1)},te=[],ne={name:"Drawer",props:{value:Boolean},methods:{handleInput:function(e){this.$emit("input",e)}}},re=ne,ae=n("8860"),ie=n("da13"),oe=n("1800"),ce=n("5d23"),se=n("f774"),ue=Object(g["a"])(re,ee,te,!1,null,null,null),le=ue.exports;w()(ue,{VIcon:k["a"],VList:ae["a"],VListItem:ie["a"],VListItemAction:oe["a"],VListItemContent:ce["a"],VListItemTitle:ce["b"],VNavigationDrawer:se["a"]});var ve={name:"App",components:{ICALProcessor:_,Calendar:X,Drawer:le},data:function(){return{drawer:!1,dialog:!1,bgImg:"https://allanchain.github.io/webnav/back.jpg"}},methods:{updateCal:function(){this.$refs.calendar.update()}}},de=ve,fe=n("7496"),pe=n("40dc"),he=n("5bc1"),me=n("a75b"),ge=Object(g["a"])(de,a,i,!1,null,null,null),be=ge.exports;w()(ge,{VApp:fe["a"],VAppBar:pe["a"],VAppBarNavIcon:he["a"],VBtn:y["a"],VContent:me["a"],VIcon:k["a"],VSpacer:N["a"],VToolbarTitle:U["a"]});var we=n("9483");Object(we["a"])("".concat("/RelaTime/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var ye=n("f309");r["a"].use(ye["a"]);var ke=new ye["a"]({});n("d1e78");r["a"].config.productionTip=!1,new r["a"]({vuetify:ke,render:function(e){return e(be)}}).$mount("#app")},ce24:function(e,t,n){}});
//# sourceMappingURL=app.3524d6bf.js.map